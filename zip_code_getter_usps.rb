require 'net/http'
require 'net/https'
require 'pry'

# This requires a USPS Web Tools account: https://www.usps.com/business/web-tools-apis/welcome.htm
# This also requires the special permission on the account to call ZipCodeLookup: 
#  "contact our Internet Customer Care Center (uspstechnicalsupport@mailps.custhelp.com) and 
#           include "Web Tools API Access" in the subject line. An agent will be happy to assist you."
usps_api_user_id = ARGV[0]

# Minneapolis city parks
street_addresses = ['28 University Ave. SE',
'2500 57th St. W',
'1320 29th Ave. NE',
'434 Main St. NE',
'110 Penn Ave. N',
'4525 Upton Ave. S.',
'1111 Summer St. NE',
'1301 10th Ave. N',
'4917 Bryant Ave. N',
'2200 West River Parkway',
'724 Sibley St. NE',
'5601 28th Ave. S',
'2000 2nd St. NE',
'2728 39th Ave. S',
'1500 Cedar Lake Parkway and Brownie Road',
'3101 Bryant Ave. S',
'601 Morgan Ave. S',
'4900 Mississippi Ct.',
'3435 Fillmore St. NE',
'2500 Cedar Ave. S',
'Cedar Lake Parkway and Basswood Road',
'2100 Cedar Lake Pkwy.',
'Cedar Lake Parkway',
'none',
'Seymour Ave. SE and Sharon Ave. SE',
'28 University Ave. SE',
'3232 Queen Ave. N',
'2433 Clinton Ave. S',
'800 Columbia Pkwy.',
'3334 20th Ave. S',
'2100 James Ave. N',
'726 Vineland Pl.',
'5001 Humboldt Ave. N',
'500 15th Ave. S',
'Dean Parkway and W. 29th St.',
'Thomas Ave. S and 45th St. W',
'1115 St. Anthony Pkwy',
'5900 Diamond Lake Lane',
'636 2nd St. NE',
'2430 3rd Ave. S',
'21st St. W and Upton Ave. S',
'2307 17th Ave. S',
'360 East River Road',
'none',
'2326 Marshall St. NE',
'1301 58th St. E',
'1000 14th St. E',
'Theodore Wirth Parkway and Glenwood Ave.',
'621 29th Ave. N',
'1201 Sheridan Ave. N',
'420 Main St. SE',
'1 West River Parkway',
'1615 Dowling Ave. N',
'101 Snelling Lake Road',
'1600 Portland Ave. S',
'925 Franklin Terrace',
'4800 Grand Ave. S',
'N. 2nd St. and Hennepin Ave.',
'2448 Ilion Ave. N',
'2000 Marshall St. NE',
'3416 4th Ave. S',
'1524 Aldrich Ave. N',
'503 Irving Ave. N',
'3474 2nd St. NE',
'4305 42nd St. E',
'none',
'301 4th St. SE',
'2212 Jackson St. NE',
'Plymouth Ave. N and West River Parkway',
'2900 Glenwood Ave. N.',
'1520 Johnson St. NE',
'2927 Irving Ave. N',
'3030 53rd St. E',
'1328 58th St. W',
'2101 Franklin Ave. W',
'3000 Calhoun Pkwy.',
'3200 E. Calhoun Pkwy.',
'2710 W. Lake St.',
'E. Calhoun Parkway',
'Thomas Ave. S and West Calhoun Parkway',
'4135 West Lake Harriet Parkway',
'4101 Lake Harriet Parkway E',
'4740 Lake Harriet Pkwy. E',
'4500 28th Ave. S',
'2701 E. 44th St.',
'4955 West Lake Nokomis Pkwy.',
'5000 Nokomis Pkwy E',
'5001 Lake Nokomis Pkwy. W',
'2500 Lake Isles Pkwy. E',
'2845 Lake of the Isles Parkway W',
'1600 26th St. W',
'Linden Hills Blvd. and 40th St. W',
'3100 43rd St. W',
'690 13th Ave. NE',
'3933 E. Minnehaha Parkway',
'4800 South Minnehaha Park Dr.',
'3435 36th Ave. S',
'1382 Willow St.',
'1382 Willow St.',
'1382 Willow St.',
'1000 James Ave. N',
'112 Williams Ave. SE',
'3845 Dupont Ave. S.',
'3900 Bryant Ave. S',
'1300 42nd St. W',
'4124 Roseway Rd.',
'4124 Roseway Road',
'1300 42nd St W',
'4124 Roseway Road',
'4124 Roseway Road',
'West 34th St. and Pillsbury Ave. So.',
'1345 Minnehaha Pkwy. W',
'711 11th Ave. SE',
'2740 Marshall St. NE',
'2318 29th Ave. S',
'906 47th St. E',
'103 Portland Ave. S',
'2117 West River Rd.',
'103 Portland Ave. S',
'51st St. W and W Minnehaha Pkwy',
'4900 Minnehaha Ave. S',
'5399 South Minnehaha Park Dr.',
'4801 South Minnehaha Park Dr.',
'West River Pkwy.',
'5200 Newton Ave. S.',
'5531 39th Ave. S',
'2509 Colfax Ave. S',
'801 22nd Ave. S',
'Federal Drive and Bloomington Road',
'40 Power St.',
'E. 50th St. and E. Nokomis Parkway',
'1801 James Ave. N',
'1701 Golden Valley Rd.',
'5114 North Mississippi Dr.',
'500 Buchanan St NE.',
'2325 West River Rd.',
'620 34th St. W',
'400 Kenwood Pkwy.',
'3113 28th St. W',
'414 Diamond Lake Rd. E',
'730 22nd St. E',
'300 34th Ave. N',
'3523 48th St. W',
'701 39th St. E',
'3400 15th Ave. S',
'4900 South Minnehaha Park Dr.',
'Theodore Wirth Parkway and Glenwood Ave.',
'3501 24th St. W',
'4055 Nicollet Ave. S',
'2700 8th St. S',
'4124 Roseway Rd.',
'726 Vineland Pl.',
'1300 Water St. NE',
'2010 50th Ave. N',
'1900 40th St. E',
'4801 South Minnehaha Park Dr.',
'Kenwood Pkwy. & 394',
'Jefferson St. NE and Spring St. NE',
'700 St. Anthony Pkwy.',
'4901 South Minnehaha Park Dr.',
'1801 Stevens Ave. S',
'2700 12th Ave. S',
'100 Portland and West River Pkwy.',
'8th Ave. N and Bryant Ave. N',
'1420 The Mall',
'3954 Bryant Avenue South',
'3300 Glenwood Ave.',
'Theodore Wirth Parkway and Olson Memorial Highway',
'1339 Theodore Wirth Pkwy.',
'900 Douglas Ave. S.',
'5600 Chicago Ave. S',
'55 Malcolm Ave. SE',
'26th Ave. N and N Theodore Wirth Pkwy.',
'901 15th Ave. SE',
'45th Ave. N and Memorial Parkway N',
'4414 Upton Ave. N',
'4701 Russell Ave. N.',
'4655 46th Avenue S',
'1810 34th Ave. NE',
'200 24th St. E',
'204 Main Street SE',
'S Chowen Ave & W 43rd St.',
'4400 Dupont Ave. N',
'4300 Webber Pkwy. N',
'none',
'425 26th St. W',
'1626 Queen Ave North',
'3810 Richfield Rd',
'William Berry Pkwy',
'2251 Hayes St. NE',
'5821 Wentworth Ave. S']

# Create te http object
http = Net::HTTP.new('production.shippingapis.com')

street_addresses.each do |street_address|
  path = '/ShippingAPITest.dll'
  data = "API=ZipCodeLookup&XML=<ZipCodeLookupRequest%20USERID=\"#{usps_api_user_id}\"><Address ID=\"0\"><Address1></Address1><Address2>#{street_address}</Address2><City>Minneapolis</City><State>MN</State></Address></ZipCodeLookupRequest>"
  
  resp, payload = http.post(path, data, nil)

  puts 'Code = ' + resp.code
  puts 'Message = ' + resp.message

  puts resp.body

end